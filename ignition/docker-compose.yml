
services:
  # Ignition Gateway
  gateway:
    image: inductiveautomation/ignition:latest
    restart: unless-stopped
    ports:
      - 8088:8088
      - 8043:8043
      - 8060:8060
      - 62541:62541
    volumes:
      - gateway-data:/usr/local/bin/ignition/data
    # env_file: ignition.env  # optionally specify variables in a file, or using `environment:` below
    environment:
      - ACCEPT_IGNITION_EULA=Y
      - GATEWAY_ADMIN_USERNAME=admin
      - GATEWAY_ADMIN_PASSWORD=password
    command: >
      -n ignition-docker
      -m 1024
      --
      wrapper.java.maxmemory=4096
      wrapper.java.initmemory=512
      -Dignition.allowunsignedmodules=true
  
  # PostgreSQL Database
  postgres:
    image: postgres:latest
    restart: unless-stopped
    environment:
      POSTGRES_DB: ignition
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    ports:
      - 5432:5432
    volumes:
      - postgres-data:/var/lib/postgresql

  # pgAdmin for PostgreSQL management
  pgadmin:
    image: dpage/pgadmin4:latest
    restart: unless-stopped
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@example.com
      PGADMIN_DEFAULT_PASSWORD: admin
      PGADMIN_CONFIG_SERVER_MODE: 'False'
    ports:
      - 5050:80
    volumes:
      - pgadmin-data:/var/lib/pgadmin
    depends_on:
      - postgres

volumes:
  gateway-data:
  postgres-data:
  pgadmin-data:
